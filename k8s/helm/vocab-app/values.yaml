global:
  domain: vocab-staging.dresponda.com
  environment: staging

api:
  replicaCount: 2
  image:
    repository: ghcr.io/desponda/vocab-app-api
    tag: sha-88216fb
    pullPolicy: Always
  service:
    type: ClusterIP
    port: 3001
  env:
    - name: NODE_ENV
      value: "production"
    - name: PORT
      value: "3001"
    - name: HOST
      value: "0.0.0.0"
    - name: CORS_ORIGIN
      value: "https://vocab-staging.dresponda.com"
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "1000m"

web:
  replicaCount: 2
  image:
    repository: ghcr.io/desponda/vocab-app-web
    tag: sha-88216fb
    pullPolicy: Always
  service:
    type: ClusterIP
    port: 3000
  env:
    - name: NODE_ENV
      value: "production"
    - name: NEXT_PUBLIC_API_URL
      value: "https://vocab-staging.dresponda.com/api"
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"

postgres:
  enabled: true
  image: postgres:16-alpine
  service:
    port: 5432
  storage:
    size: 10Gi
  env:
    - name: POSTGRES_DB
      value: "vocab_app_staging"
    - name: POSTGRES_USER
      value: "postgres"

redis:
  enabled: true
  image: redis:7-alpine
  service:
    port: 6379
  storage:
    size: 2Gi

minio:
  # MinIO credentials are auto-generated by secret-generator-job
  # Secret is created automatically with random accessKey and secretKey
  createFromHelm: false
  secretName: "vocab-app-minio-secret"

  # MinIO endpoint configuration
  # For external MinIO Tenant: use the tenant service endpoint
  endpoint: "vocab-app-storage-hl.default.svc.cluster.local"
  port: 9000
  useSSL: false
  bucket: "vocab-documents"

ingress:
  enabled: true
  className: cloudflare-tunnel
  host: vocab-staging.dresponda.com
  annotations:
    cert-manager.io/cluster-issuer: "cloudflare"

# Secrets Management:
# IMPORTANT: Secrets are NOT stored in this file (which is checked into git)
# Instead, create them manually using: k8s/scripts/create-secrets.sh
# Or override with: helm install --set-file secrets.jwtAccessSecret=./jwt-secret.txt
secrets:
  # External secret name (created outside of Helm)
  externalSecretName: "vocab-app-secrets"

  # Set to true only for local development (creates secret from values below)
  # NEVER use in production - use external secret management instead
  createFromHelm: false

  # Only used if createFromHelm=true (local dev only)
  # Must meet validation: JWT secrets >= 32 chars
  postgresPassword: ""
  jwtAccessSecret: ""
  jwtRefreshSecret: ""
  anthropicApiKey: ""
